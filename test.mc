include "int.mc"
-- include "seq.mc"
include "math.mc"
let maxi = lam a. lam b. if gti a b then a else b

let create = lam l. lam f.
  recursive let rec = lam i. lam acc.
    if geqi i 0 then rec (subi i 1) (cons (f i) acc)
    else acc
  in rec (subi l 1) []

let make : all a. Int -> a -> [a] = lam n. lam v. create n (lam. v)

let foldl = lam f. lam acc. lam s.
  recursive let rec = lam acc. lam s.
    match s with [] then acc
    else match s with [a] ++ ss then rec (f acc a) ss
    else never
  in rec acc s

let join : all a. [[a]] -> [a] = lam seqs. foldl concat [] seqs

recursive
  let any : all a. (a -> Bool) -> [a] -> Bool = lam p. lam seq.
    if null seq
    then false
    else if p (head seq) then true else any p (tail seq)
end

recursive let foldl2 : all a. all b. all c. (a -> b -> c -> a) -> a -> [b] -> [c] -> a = lam f. lam a. lam bs. lam cs.
  match (bs, cs) with ([b] ++ bs, [c] ++ cs)
  then foldl2 f (f a b c) bs cs
  else a
end

let zipWith : all a. all b. all c. (a -> b -> c) -> [a] -> [b] -> [c] =
  lam f. foldl2 (lam acc. lam x1. lam x2. snoc acc (f x1 x2)) []

let mapAccumL : all a. all b. all c. (a -> b -> (a, c)) -> a -> [b] -> (a, [c]) =
  lam f : (a -> b -> (a, c)). lam acc. lam seq.
    foldl
      (lam tacc : (a, [c]). lam x.
         match f tacc.0 x with (acc, y) then (acc, snoc tacc.1 y) else never)
      (acc, []) seq

let zipWithIndex : all a. all b. all c. (Int -> a -> b -> c) -> [a] -> [b] -> [c] =
  lam f. lam a1. lam a2.
  recursive let work = lam acc. lam i. lam seq1. lam seq2.
    match seq1 with [e1] ++ seq1tail then
      match seq2 with [e2] ++ seq2tail then
        work (cons (f i e1 e2) acc)
             (addi i 1)
             seq1tail
             seq2tail
      else reverse acc
    else reverse acc
  in
  work [] 0 a1 a2

type Tree
con Leaf : {age: Float, msg: [[Float]], id: Int} -> Tree

let data = [
[0, 0, 2, 3, 3, 3, 1, 0, 3, 3, 2, 2, 0, 2, 1, 1, 0, 1, 1, 0, 1, 3, 1, 3, 3, 0, 3, 0, 0, 3, 3, 2, 1, 1, 1, 0, 3, 2, 2, 1, 1, 3, 1, 0, 1, 1, 3, 1, 1, 3, 1, 1, 1, 3, 0, 3, 3, 0, 3, 3, 3, 3, 2, 1, 1, 3, 0, 2, 1, 0, 0, 0, 3, 0, 1, 0, 0, 0, 1, 3, 0, 1, 2, 0, 0, 1, 2, 0, 2, 3, 1, 1, 0, 1, 0, 2, 3, 1, 2, 0, 0, 1, 0, 0, 3, 0, 2, 1, 0, 1, 3, 0, 2, 1, 1, 1, 2, 3, 2, 2, 1, 1, 3, 3, 1, 0, 0, 0, 1, 1, 1, 3, 0, 3, 3, 0, 1, 1, 3, 1, 3, 3, 2, 1, 0, 2, 1, 0, 0, 1, 0, 3, 2, 0, 3, 2, 0, 1, 3, 1, 1, 3, 1, 2, 1, 1, 0, 2, 1, 3, 3, 0, 0, 1, 1, 0, 0, 1, 1, 3, 2, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 3, 3, 0, 0, 3, 3, 3, 0, 0, 3, 1, 2, 2, 3, 2, 0, 0, 1, 3, 2, 3, 1, 1, 2, 3, 0, 0, 3, 0, 0, 3, 0, 2, 1, 0, 2, 1, 0, 3, 3, 3, 3, 1, 0, 3, 2, 2, 3, 1, 0, 1, 0, 1, 1, 3, 0, 0, 1, 3, 0, 3, 3, 0, 3, 1, 3, 3, 0, 2, 3, 0, 2, 2, 1, 1, 3, 3, 0, 0, 1, 0, 1, 1, 1, 3, 3, 0, 3, 1, 0, 1, 1, 2, 1, 1, 1, 3, 0, 3, 0, 3, 3, 1, 1, 1, 3, 0, 3, 0, 3, 0, 3, 0, 1, 3, 0, 0, 3, 1, 0, 3, 0, 0, 1, 3, 1, 0, 0, 1, 2, 0, 2, 2, 0, 0, 0, 0, 3, 0, 1, 0, 1, 0, 3, 0, 3, 1, 0, 3, 0, 3, 1, 0, 0, 1, 0, 0, 3, 0, 3, 1, 0, 3, 2, 1, 1, 1, 1, 1, 3, 3, 3, 1, 0, 1, 1, 1, 2, 0, 2, 0, 0, 0, 0, 3, 0, 1, 0, 3, 3, 0, 0, 3, 0, 0, 3, 1, 0, 3, 0, 1, 0, 1, 1, 3, 0, 3, 3, 3, 1, 1, 1, 3, 3, 0, 0, 3, 1, 1, 3, 0, 1, 3, 0, 3, 1, 3, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 2, 3, 0, 0, 3, 3, 0, 3, 0, 2, 2, 0, 0, 1, 1, 0, 3, 2, 3, 0, 1, 3, 2, 3, 0, 0, 0, 3, 0, 3, 0, 2, 3, 3, 3, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 3, 3, 0, 2, 0, 3, 3, 2, 3, 2, 0, 2, 3, 1, 3, 0, 0, 3, 0, 0, 3, 0, 2, 0, 0, 2, 1, 1, 1, 0, 0, 0, 2, 0, 3, 3, 3, 1, 3, 3, 0, 3, 3, 3, 0, 1, 1, 0, 0, 2, 0, 0, 0, 2, 3, 0, 4, 3, 2, 1, 0, 0, 2, 0, 0, 1, 3, 2, 1, 3, 0, 0, 1, 3, 1, 0, 3, 2, 1, 1, 3, 1, 1, 0, 3, 0, 3, 0, 3, 0, 0, 1, 0, 0, 3, 2, 3, 2, 2, 1, 3, 3, 3, 1, 3, 3, 4, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 2, 0, 0, 2, 3, 0, 0, 3, 1, 1, 0, 3, 1, 2, 2, 3, 1, 3, 3, 0, 2, 2, 0, 0, 1, 1, 2, 0, 0, 0, 0, 4, 0, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 0, 0, 3, 3, 3, 0, 3, 3, 3, 3, 1, 0, 3, 1, 1, 3, 1, 1, 0, 3, 3, 3, 3, 0, 1, 3, 0, 3, 1, 0, 1, 3, 3, 0, 1, 0, 1, 3, 1, 3, 3, 0, 0, 3, 3, 0, 1, 1, 1, 1, 0, 3, 3, 3, 0, 3, 3, 0, 3, 3, 0, 1, 0, 0, 1, 0, 0, 1, 3, 0, 0, 0, 0, 0, 0, 3, 0, 3, 2, 0, 0, 0, 1, 0, 1, 0, 3, 2, 1, 0, 3, 0, 1, 1, 1, 3, 3, 0, 1, 3, 0, 1, 2, 3, 0, 0, 0, 0, 0, 0, 1, 3, 1, 3, 0, 3, 1, 2, 1, 1, 3, 2, 1, 2, 1, 0, 3, 3, 3, 0, 3, 0, 0, 1, 0, 0, 2, 1, 1, 3, 0, 2, 3, 1, 1, 1, 0, 0, 3, 2, 1, 3, 1, 0, 3, 0, 3, 3, 3, 1, 3, 0, 3, 0, 1, 0, 1, 0, 0, 0, 3, 1, 0, 0, 2, 0, 0, 0, 3, 0, 0, 3, 1, 0, 3, 3, 3, 1, 1, 0, 0, 1, 3, 2, 0, 1, 0, 3, 3, 2, 0, 0, 3, 0, 0, 1, 2, 0, 3, 3, 1, 0, 3, 0, 1, 3, 0, 3, 1, 0, 0, 0, 3, 3, 0, 3, 2, 1, 1, 3, 0, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 1, 0, 3, 0, 2, 2, 0, 2, 1, 0, 0, 1, 1, 0, 3, 3, 1, 3, 0, 0, 3, 0, 0, 3, 1, 2, 1, 0, 1, 0, 3, 2, 2, 1, 1, 3, 3, 0, 1, 0, 3, 1, 0, 3, 1, 1, 0, 3, 0, 3, 3, 0, 3, 3, 1, 3, 2, 3, 1, 3, 0, 2, 1, 1, 0, 0, 1, 3, 1, 3, 0, 0, 1, 3, 0, 1, 2, 0, 0, 1, 2, 0, 0, 3, 1, 1, 0, 3, 0, 2, 1, 1, 2, 3, 0, 1, 0, 0, 3, 0, 1, 3, 0, 1, 3, 0, 2, 1, 0, 1, 2, 0, 2, 2, 2, 0, 3, 1, 1, 0, 0, 0, 1, 1, 0, 3, 3, 1, 3, 1, 1, 1, 3, 1, 3, 3, 0, 3, 0, 2, 1, 1, 0, 1, 1, 3, 2, 0, 3, 2, 0, 1, 3, 0, 1, 3, 1, 2, 1, 1, 0, 2, 1, 1, 3, 0, 0, 1, 3, 0, 0, 1, 1, 3, 0, 2, 1, 1, 1, 3, 0, 1, 1, 1, 0, 1, 1, 3, 1, 3, 0, 3, 1, 0, 0, 3, 3, 3, 0, 0, 3, 3, 2, 2, 1, 2, 0, 0, 1, 3, 0, 3, 3, 1, 2, 3, 1, 0, 1, 3, 0, 3, 0, 2, 1, 0, 3, 1, 1, 3, 3, 1, 3, 1, 0, 3, 2, 0, 3, 1, 0, 0, 0, 1, 0, 3, 3, 0, 1, 0, 0, 3, 3, 0, 3, 1, 3, 3, 0, 0, 3, 0, 2, 2, 1, 3, 3, 0, 0, 0, 3, 0, 3, 2, 1, 3, 1, 0, 3, 1, 0, 1, 1, 2, 1, 3, 1, 3, 1, 3, 0, 3, 3, 1, 1, 1, 3, 1, 3, 0, 3, 0, 3, 0, 3, 3, 0, 0, 1, 3, 0, 1, 3, 0, 1, 0, 1, 0, 0, 1, 2, 0, 2, 2, 0, 0, 0, 0, 1, 3, 1, 0, 1, 0, 3, 0, 3, 1, 0, 3, 3, 1, 2, 1, 0, 1, 0, 0, 1, 1, 3, 0, 0, 0, 1, 1, 1, 0, 3, 1, 1, 3, 3, 3, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 0, 1, 0, 1, 1, 1, 3, 3, 0, 3, 0, 3, 1, 1, 0, 3, 0, 1, 0, 1, 0, 3, 0, 1, 3, 1, 1, 1, 1, 1, 3, 3, 1, 3, 1, 1, 3, 0, 3, 3, 3, 0, 1, 1, 3, 3, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 3, 3, 0, 3, 3, 1, 3, 0, 2, 2, 0, 1, 1, 1, 0, 1, 2, 3, 0, 1, 3, 2, 3, 0, 0, 0, 3, 0, 3, 0, 2, 3, 3, 3, 0, 0, 0, 4, 0, 0, 0, 0, 1, 0, 1, 3, 0, 2, 0, 3, 3, 2, 3, 2, 0, 0, 3, 1, 1, 0, 2, 0, 0, 0, 3, 0, 2, 0, 0, 2, 1, 3, 1, 0, 0, 0, 1, 4, 1, 3, 3, 1, 3, 3, 0, 3, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 2, 3, 0, 0, 3, 2, 3, 0, 3, 2, 0, 0, 1, 3, 2, 1, 3, 0, 0, 1, 3, 1, 3, 2, 1, 0, 1, 3, 1, 1, 2, 3, 0, 3, 0, 3, 0, 0, 0, 0, 0, 3, 0, 1, 2, 2, 1, 3, 0, 3, 1, 3, 1, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 2, 0, 0, 2, 3, 0, 0, 3, 1, 1, 0, 3, 3, 2, 2, 1, 1, 3, 3, 0, 2, 2, 0, 2, 1, 1, 0, 0, 0, 0, 0, 4, 0, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 0, 0, 3, 1, 3, 0, 3, 3, 0, 3, 1, 1, 3, 1, 3, 3, 3, 1, 0, 1, 1, 1, 3, 3, 2, 3, 1, 0, 1, 0, 1, 3, 2, 0, 3, 3, 0, 3, 1, 1, 3, 0, 0, 1, 3, 3, 3, 0, 1, 1, 3, 0, 3, 1, 0, 3, 3, 0, 3, 0, 0, 0, 1, 2, 3, 3, 0, 1, 0, 0, 0, 1, 0, 3, 0, 3, 0, 1, 0, 0, 0, 0, 0, 1, 3, 0, 1, 1, 1, 1, 3, 0, 3, 2, 1, 0, 1, 1, 0, 3, 0, 1, 2, 3, 0, 0, 0, 0, 3, 1, 3, 3, 1, 3, 0, 3, 3, 2, 1, 0, 3, 2, 3, 2, 1, 1, 3, 3, 1, 0, 3, 1, 0, 1, 3, 0, 2, 1, 1, 3, 1, 0, 3, 1, 1, 1, 0, 0, 1, 3, 0, 3, 0, 3, 3, 0, 3, 3, 3, 0, 3, 1, 3, 1, 1, 3, 1, 0, 2, 2, 0, 1, 0, 0, 2, 0, 0, 0, 1, 0, 0, 3, 1, 0, 3, 3, 3, 1, 1, 0, 0, 1, 3, 2, 0, 1, 0, 3, 3, 2, 0, 0, 3, 0, 0, 1, 0, 0, 3, 1, 1, 0, 0, 0, 1, 1, 1, 3, 0, 0, 0, 0, 1, 3, 0, 3, 1, 3, 0, 3, 3, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 1, 0, 1, 1, 2, 2, 1, 2, 1, 0, 2, 3, 1, 0, 3, 3, 1, 3, 1, 0, 3, 0, 0, 3, 1, 2, 1, 1, 1, 0, 1, 2, 2, 2, 1, 3, 3, 0, 1, 0, 3, 1, 1, 3, 1, 0, 3, 3, 0, 1, 3, 0, 3, 3, 1, 3, 2, 1, 1, 3, 0, 2, 1, 0, 0, 0, 1, 3, 1, 0, 0, 0, 1, 3, 0, 1, 2, 0, 0, 1, 2, 1, 0, 1, 3, 1, 0, 1, 0, 2, 3, 1, 2, 1, 0, 3, 1, 0, 3, 0, 0, 3, 1, 1, 3, 1, 3, 1, 3, 1, 0, 0, 2, 2, 0, 1, 3, 3, 1, 0, 0, 0, 1, 3, 1, 3, 0, 1, 3, 1, 1, 1, 0, 1, 3, 0, 0, 3, 0, 2, 1, 3, 3, 3, 3, 3, 2, 0, 3, 2, 0, 1, 3, 3, 1, 3, 0, 2, 1, 0, 0, 2, 1, 1, 3, 1, 2, 1, 3, 0, 0, 1, 1, 3, 1, 2, 1, 1, 3, 3, 0, 1, 1, 1, 1, 1, 1, 0, 1, 3, 0, 3, 3, 0, 0, 1, 1, 3, 0, 1, 3, 2, 2, 2, 0, 2, 0, 0, 1, 3, 1, 3, 1, 3, 2, 3, 2, 1, 3, 0, 2, 3, 0, 0, 1, 1, 0, 1, 2, 3, 3, 1, 3, 1, 1, 3, 2, 0, 3, 1, 0, 0, 0, 3, 0, 3, 1, 0, 1, 3, 1, 3, 1, 1, 3, 0, 1, 3, 3, 0, 1, 0, 2, 2, 0, 1, 3, 1, 0, 0, 1, 0, 3, 0, 1, 3, 0, 2, 3, 1, 0, 1, 0, 2, 1, 1, 1, 3, 0, 3, 0, 1, 3, 1, 1, 1, 3, 1, 3, 0, 1, 0, 3, 0, 3, 3, 3, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 3, 2, 2, 2, 2, 1, 3, 1, 0, 1, 3, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 3, 3, 0, 0, 1, 0, 0, 1, 0, 3, 0, 0, 0, 0, 1, 1, 1, 3, 1, 0, 3, 3, 1, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 0, 1, 0, 1, 1, 1, 3, 1, 0, 3, 2, 3, 3, 1, 0, 3, 0, 1, 0, 1, 1, 3, 0, 3, 1, 1, 1, 1, 1, 0, 3, 3, 1, 3, 1, 1, 3, 1, 1, 3, 0, 3, 1, 1, 1, 3, 1, 0, 0, 1, 1, 1, 1, 2, 0, 1, 0, 3, 1, 0, 3, 3, 0, 1, 1, 2, 2, 2, 3, 3, 3, 3, 1, 1, 3, 1, 3, 3, 2, 3, 0, 0, 0, 3, 0, 3, 0, 2, 3, 3, 3, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 3, 1, 0, 2, 0, 3, 3, 2, 3, 2, 0, 0, 3, 1, 3, 2, 0, 1, 0, 0, 1, 0, 2, 0, 2, 2, 1, 3, 3, 0, 4, 1, 2, 0, 1, 1, 1, 1, 3, 3, 0, 3, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 2, 1, 3, 4, 1, 0, 1, 0, 0, 2, 0, 0, 1, 3, 2, 1, 3, 0, 0, 1, 3, 1, 0, 3, 2, 1, 1, 1, 1, 1, 0, 3, 2, 3, 1, 3, 0, 0, 1, 0, 0, 1, 0, 3, 2, 2, 1, 3, 3, 3, 1, 3, 1, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 0, 1, 0, 2, 1, 3, 0, 3, 1, 1, 0, 3, 3, 2, 2, 3, 1, 3, 3, 0, 2, 2, 1, 1, 1, 1, 0, 0, 0, 0, 0, 3, 3, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 0, 1, 1, 0, 3, 2, 1, 0, 1, 0, 1, 3, 0, 1, 3, 0, 3, 0, 0, 1, 1, 0, 1, 1, 1, 3, 0, 0, 1, 1, 1, 3, 2, 0, 1, 3, 3, 1, 1, 1, 3, 0, 0, 3, 3, 1, 1, 1, 1, 1, 1, 0, 3, 1, 1, 3, 3, 0, 1, 1, 0, 1, 1, 1, 3, 1, 2, 3, 3, 0, 0, 1, 1, 1, 3, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 1, 0, 3, 0, 1, 1, 1, 1, 1, 0, 3, 3, 0, 3, 2, 3, 0, 0, 0, 0, 3, 1, 1, 0, 3, 3, 2, 3, 1, 2, 1, 0, 3, 1, 1, 0, 1, 1, 3, 3, 3, 0, 3, 3, 0, 3, 1, 0, 2, 3, 1, 3, 1, 3, 3, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 3, 0, 3, 3, 1, 0, 3, 2, 3, 2, 1, 1, 3, 0, 2, 0, 1, 1, 0, 0, 2, 0, 0, 2, 3, 3, 0, 3, 3, 0, 3, 1, 3, 1, 2, 0, 0, 1, 3, 2, 0, 1, 0, 1, 3, 2, 0, 2, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 2, 1, 3, 1, 3, 1, 1, 1, 3, 0, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 1, 0, 1, 1, 2, 2, 1, 2, 1, 0, 0, 3, 3, 0, 3, 1, 1, 3, 1, 0, 3, 0, 0, 3, 1, 2, 1, 1, 1, 0, 1, 2, 2, 0, 1, 3, 3, 0, 1, 0, 3, 1, 1, 3, 1, 0, 3, 3, 0, 3, 3, 0, 3, 3, 1, 3, 2, 1, 1, 3, 0, 2, 1, 0, 0, 0, 1, 3, 1, 0, 0, 0, 3, 3, 0, 3, 2, 0, 0, 1, 2, 1, 0, 1, 1, 1, 0, 1, 0, 2, 3, 1, 2, 1, 0, 3, 1, 0, 3, 0, 0, 3, 3, 1, 3, 1, 3, 1, 1, 1, 0, 0, 2, 2, 0, 1, 3, 3, 1, 0, 0, 0, 1, 3, 1, 3, 0, 1, 3, 1, 1, 1, 0, 1, 3, 0, 0, 3, 0, 2, 1, 1, 3, 3, 3, 3, 2, 0, 3, 2, 0, 1, 3, 1, 1, 3, 0, 2, 1, 0, 0, 2, 1, 1, 3, 1, 2, 1, 3, 0, 0, 1, 1, 3, 1, 2, 1, 1, 1, 3, 0, 1, 1, 1, 1, 1, 3, 0, 1, 1, 0, 3, 3, 0, 0, 3, 1, 3, 1, 1, 3, 0, 2, 2, 2, 2, 0, 0, 1, 3, 1, 3, 1, 1, 2, 3, 2, 1, 3, 0, 2, 3, 0, 0, 1, 1, 3, 1, 0, 3, 3, 1, 3, 1, 1, 3, 2, 0, 3, 1, 0, 0, 0, 3, 0, 1, 1, 0, 1, 3, 1, 3, 1, 1, 3, 0, 1, 3, 1, 0, 1, 0, 2, 2, 0, 3, 3, 1, 0, 0, 1, 0, 3, 0, 1, 3, 0, 0, 3, 1, 0, 1, 0, 2, 1, 1, 1, 3, 2, 3, 0, 1, 3, 1, 1, 1, 3, 1, 3, 0, 1, 0, 3, 2, 3, 3, 3, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 3, 2, 0, 2, 2, 1, 3, 1, 0, 1, 3, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 3, 3, 0, 0, 3, 0, 0, 1, 0, 3, 0, 0, 0, 2, 1, 1, 1, 3, 1, 0, 3, 3, 1, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 0, 3, 0, 1, 3, 1, 3, 1, 0, 3, 0, 3, 3, 3, 3, 3, 0, 1, 0, 1, 1, 3, 0, 3, 1, 1, 1, 1, 1, 0, 3, 1, 1, 3, 1, 1, 3, 3, 1, 3, 0, 3, 1, 1, 1, 3, 1, 0, 0, 3, 1, 1, 3, 2, 0, 3, 0, 3, 1, 0, 3, 1, 0, 1, 3, 2, 2, 0, 3, 3, 1, 0, 1, 1, 3, 1, 1, 3, 2, 3, 0, 0, 0, 3, 0, 3, 0, 2, 3, 3, 3, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 3, 1, 0, 2, 0, 3, 3, 2, 3, 2, 0, 0, 3, 1, 3, 2, 0, 1, 0, 0, 1, 0, 2, 0, 2, 2, 1, 3, 1, 0, 4, 1, 2, 0, 1, 1, 1, 1, 3, 3, 0, 3, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 2, 1, 3, 4, 3, 0, 3, 0, 0, 2, 0, 0, 1, 3, 2, 1, 3, 0, 0, 3, 3, 1, 0, 3, 0, 3, 1, 1, 1, 1, 0, 3, 2, 1, 1, 3, 2, 0, 1, 0, 0, 1, 0, 3, 2, 2, 1, 3, 3, 3, 1, 3, 1, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 0, 1, 0, 2, 1, 1, 0, 3, 1, 1, 2, 3, 3, 2, 2, 3, 1, 3, 3, 0, 2, 2, 1, 1, 1, 1, 0, 0, 0, 0, 0, 3, 3, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 0, 1, 1, 0, 3, 2, 3, 0, 3, 0, 1, 3, 0, 1, 1, 0, 3, 0, 0, 1, 1, 0, 1, 1, 3, 3, 0, 0, 1, 1, 1, 3, 0, 0, 1, 3, 1, 1, 1, 3, 3, 0, 0, 3, 3, 1, 3, 1, 1, 1, 1, 0, 3, 1, 1, 3, 1, 0, 1, 1, 0, 1, 1, 1, 3, 1, 0, 3, 3, 0, 0, 1, 1, 1, 3, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 1, 0, 3, 0, 3, 1, 1, 1, 1, 0, 3, 3, 0, 3, 2, 3, 2, 0, 0, 0, 3, 1, 1, 0, 3, 3, 0, 3, 1, 2, 1, 2, 3, 1, 1, 0, 1, 1, 3, 3, 3, 0, 3, 1, 0, 3, 3, 0, 2, 1, 1, 3, 3, 3, 3, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 3, 0, 3, 3, 1, 0, 3, 0, 3, 2, 1, 1, 3, 0, 2, 0, 1, 1, 0, 0, 2, 0, 0, 2, 1, 3, 0, 3, 3, 0, 3, 1, 3, 1, 0, 0, 0, 1, 3, 2, 2, 1, 0, 1, 3, 2, 0, 2, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 2, 1, 3, 1, 3, 1, 1, 1, 3, 0, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 1, 0, 1, 1, 2, 2, 1, 2, 1, 0, 2, 3, 3, 2, 3, 3, 1, 3, 3, 0, 3, 0, 0, 3, 3, 2, 1, 1, 1, 0, 1, 2, 2, 0, 1, 3, 3, 0, 1, 0, 3, 1, 0, 3, 1, 0, 3, 3, 0, 3, 3, 0, 3, 3, 1, 3, 2, 1, 1, 3, 0, 2, 1, 0, 0, 0, 1, 3, 1, 0, 0, 0, 1, 3, 0, 1, 2, 0, 0, 1, 2, 0, 0, 1, 1, 1, 0, 1, 0, 2, 1, 1, 2, 1, 0, 3, 1, 0, 3, 0, 0, 3, 3, 1, 3, 1, 3, 1, 3, 1, 0, 0, 2, 2, 0, 1, 3, 1, 1, 0, 0, 0, 1, 1, 1, 3, 0, 1, 3, 1, 1, 1, 0, 1, 3, 0, 0, 3, 0, 2, 1, 1, 1, 3, 3, 3, 2, 0, 3, 2, 0, 1, 3, 3, 1, 3, 2, 2, 1, 0, 0, 2, 1, 1, 3, 1, 2, 1, 1, 0, 0, 1, 1, 3, 1, 2, 1, 1, 3, 3, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 3, 3, 0, 0, 1, 1, 3, 0, 1, 3, 0, 2, 2, 0, 2, 0, 2, 1, 3, 1, 3, 1, 1, 2, 3, 0, 1, 3, 0, 2, 3, 0, 0, 1, 1, 0, 1, 0, 3, 3, 1, 3, 1, 1, 3, 2, 0, 3, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 3, 3, 3, 3, 0, 1, 3, 3, 0, 1, 0, 2, 2, 0, 3, 1, 3, 0, 0, 1, 0, 3, 0, 1, 3, 0, 0, 3, 3, 0, 1, 0, 2, 1, 1, 1, 3, 2, 3, 0, 1, 3, 1, 1, 1, 3, 3, 3, 0, 3, 0, 3, 0, 3, 3, 3, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 3, 2, 0, 2, 2, 1, 1, 1, 0, 1, 3, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 3, 1, 0, 1, 1, 0, 0, 1, 0, 3, 0, 0, 0, 0, 1, 1, 1, 3, 1, 0, 3, 3, 3, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 0, 1, 0, 3, 1, 1, 3, 1, 0, 3, 0, 3, 3, 1, 0, 3, 2, 1, 0, 1, 1, 3, 0, 3, 1, 1, 1, 1, 1, 0, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 0, 3, 1, 1, 1, 3, 1, 0, 0, 1, 1, 1, 1, 2, 0, 3, 0, 3, 3, 0, 3, 1, 0, 1, 1, 2, 2, 2, 3, 3, 1, 0, 1, 1, 3, 1, 1, 3, 2, 3, 0, 0, 0, 3, 0, 3, 0, 2, 3, 3, 3, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 3, 1, 0, 2, 0, 3, 3, 2, 3, 2, 0, 0, 3, 1, 3, 2, 0, 3, 0, 0, 1, 0, 2, 0, 2, 2, 1, 3, 1, 0, 4, 1, 0, 0, 1, 1, 1, 1, 3, 3, 0, 3, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 2, 1, 3, 4, 1, 2, 3, 0, 0, 2, 0, 2, 1, 3, 2, 1, 3, 0, 0, 1, 3, 1, 0, 3, 0, 1, 1, 1, 1, 1, 2, 3, 2, 1, 3, 3, 2, 0, 1, 0, 0, 1, 0, 3, 2, 2, 1, 3, 3, 3, 1, 3, 1, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 0, 1, 0, 2, 1, 3, 0, 3, 1, 1, 0, 3, 3, 2, 2, 3, 1, 3, 3, 0, 2, 2, 0, 1, 1, 1, 0, 0, 0, 0, 0, 3, 3, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 0, 1, 3, 0, 3, 2, 3, 0, 1, 2, 1, 3, 0, 1, 1, 0, 3, 0, 0, 1, 1, 0, 1, 1, 3, 3, 0, 2, 1, 1, 1, 3, 0, 0, 1, 3, 3, 1, 1, 3, 3, 0, 0, 3, 3, 1, 1, 1, 1, 1, 3, 0, 3, 1, 1, 3, 3, 0, 1, 1, 0, 1, 1, 3, 3, 1, 0, 3, 1, 0, 0, 3, 1, 1, 3, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 1, 3, 1, 0, 3, 0, 1, 1, 1, 1, 1, 0, 3, 3, 0, 1, 2, 3, 0, 0, 0, 0, 3, 1, 3, 0, 3, 1, 2, 3, 1, 2, 1, 0, 3, 1, 1, 0, 1, 1, 3, 3, 3, 0, 3, 1, 0, 3, 1, 0, 2, 1, 1, 3, 1, 3, 3, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 3, 0, 3, 3, 3, 1, 3, 0, 3, 2, 1, 1, 3, 0, 2, 0, 1, 1, 0, 0, 2, 0, 0, 2, 1, 3, 0, 3, 3, 0, 3, 1, 3, 1, 0, 0, 2, 1, 3, 2, 0, 1, 0, 1, 3, 2, 0, 2, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 3, 3, 1, 0, 0, 1, 3, 1, 3, 1, 1, 1, 3, 0, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 1, 0, 1, 1, 2, 2, 1, 2, 1, 0, 0, 1, 1, 0, 1, 1, 1, 3, 1, 0, 3, 2, 0, 3, 3, 2, 1, 1, 1, 0, 3, 2, 2, 0, 1, 3, 1, 0, 1, 0, 3, 1, 1, 3, 1, 1, 1, 3, 0, 1, 3, 2, 3, 3, 1, 3, 2, 1, 1, 3, 0, 2, 1, 0, 0, 0, 1, 3, 1, 0, 0, 0, 1, 3, 0, 1, 2, 0, 0, 1, 2, 0, 0, 1, 1, 1, 0, 1, 0, 2, 1, 1, 2, 1, 0, 3, 1, 0, 3, 0, 0, 3, 1, 1, 3, 1, 3, 1, 3, 1, 0, 0, 2, 2, 1, 1, 3, 3, 1, 0, 0, 0, 1, 3, 1, 3, 0, 1, 3, 1, 1, 1, 1, 1, 3, 0, 0, 3, 0, 2, 1, 1, 1, 3, 1, 3, 2, 0, 3, 2, 0, 1, 3, 3, 1, 3, 0, 2, 1, 0, 0, 2, 1, 1, 3, 1, 0, 1, 3, 0, 0, 1, 1, 3, 3, 2, 1, 1, 1, 3, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 3, 1, 0, 0, 1, 1, 3, 3, 1, 3, 0, 2, 2, 0, 2, 0, 0, 1, 3, 1, 3, 1, 1, 2, 3, 0, 1, 3, 0, 0, 3, 0, 2, 1, 1, 0, 3, 0, 3, 3, 1, 3, 1, 3, 3, 2, 0, 3, 1, 3, 0, 0, 1, 0, 3, 1, 0, 1, 1, 0, 3, 1, 1, 3, 0, 1, 3, 0, 0, 1, 0, 2, 2, 0, 1, 3, 1, 0, 0, 1, 0, 3, 0, 1, 3, 0, 0, 3, 1, 0, 1, 0, 0, 1, 1, 1, 3, 0, 3, 0, 1, 3, 1, 3, 1, 3, 1, 3, 0, 3, 0, 3, 0, 3, 3, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 2, 0, 2, 2, 3, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 3, 1, 0, 0, 1, 0, 0, 1, 0, 3, 0, 0, 0, 0, 1, 1, 3, 3, 1, 3, 3, 3, 1, 0, 1, 0, 1, 2, 1, 2, 0, 0, 0, 0, 3, 0, 1, 1, 1, 3, 1, 0, 3, 2, 1, 3, 1, 0, 3, 0, 1, 0, 1, 1, 3, 0, 3, 1, 1, 1, 1, 1, 0, 3, 1, 1, 3, 1, 1, 3, 1, 3, 3, 0, 3, 1, 1, 1, 3, 1, 0, 0, 1, 1, 1, 1, 0, 2, 1, 0, 3, 1, 0, 3, 1, 2, 1, 3, 2, 2, 2, 3, 3, 1, 2, 1, 1, 3, 0, 1, 3, 2, 3, 0, 0, 0, 3, 0, 3, 0, 2, 3, 3, 3, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 3, 3, 0, 2, 0, 3, 3, 2, 3, 2, 0, 0, 3, 1, 3, 0, 0, 3, 0, 0, 3, 0, 2, 2, 2, 1, 1, 1, 1, 0, 4, 1, 0, 0, 1, 1, 1, 1, 3, 3, 0, 3, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 2, 1, 3, 4, 1, 0, 1, 0, 0, 2, 0, 0, 1, 3, 2, 1, 3, 0, 0, 1, 3, 1, 3, 1, 0, 1, 3, 4, 1, 1, 0, 3, 2, 3, 2, 3, 2, 0, 1, 0, 0, 1, 0, 3, 2, 2, 1, 3, 3, 3, 1, 3, 1, 0, 2, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 0, 1, 0, 2, 1, 3, 0, 3, 1, 1, 1, 3, 3, 2, 2, 3, 1, 3, 3, 0, 2, 2, 0, 3, 1, 1, 0, 0, 0, 0, 0, 3, 3, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 1, 0, 2, 1, 1, 0, 3, 2, 3, 3, 3, 0, 1, 1, 0, 1, 1, 0, 3, 0, 0, 1, 3, 2, 1, 1, 1, 3, 1, 0, 1, 1, 3, 3, 0, 0, 1, 3, 3, 1, 1, 1, 3, 0, 0, 3, 1, 1, 1, 1, 1, 1, 1, 0, 3, 3, 0, 1, 1, 2, 1, 3, 0, 1, 1, 1, 3, 1, 0, 3, 3, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 3, 0, 1, 1, 1, 1, 1, 0, 1, 3, 0, 3, 2, 3, 0, 0, 0, 0, 0, 1, 2, 2, 1, 1, 0, 3, 1, 2, 1, 0, 3, 1, 1, 2, 1, 1, 3, 3, 3, 0, 1, 3, 0, 3, 1, 0, 2, 1, 1, 3, 3, 0, 3, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 3, 0, 3, 3, 3, 0, 3, 1, 3, 2, 1, 1, 3, 0, 2, 2, 0, 1, 0, 0, 2, 0, 0, 0, 1, 1, 0, 3, 1, 2, 3, 1, 0, 1, 0, 0, 0, 1, 3, 2, 0, 3, 2, 1, 3, 2, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 2, 0, 1, 0, 1, 3, 0, 1, 0, 0, 1, 3, 1, 3, 1, 0, 1, 3, 0, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 3, 0, 1, 0, 2, 2, 3, 2, 1, 0, 0, 1, 1, 2, 3, 1, 1, 3, 1, 0, 3, 0, 0, 3, 1, 2, 1, 1, 1, 0, 1, 2, 2, 0, 1, 3, 0, 0, 1, 1, 3, 1, 3, 3, 1, 1, 1, 3, 2, 1, 3, 0, 3, 3, 1, 3, 2, 1, 1, 3, 3, 2, 1, 0, 0, 0, 1, 3, 1, 0, 0, 0, 1, 3, 0, 1, 2, 0, 0, 1, 2, 0, 0, 1, 3, 1, 0, 1, 0, 2, 1, 1, 2, 1, 0, 3, 1, 0, 3, 0, 0, 3, 1, 1, 3, 0, 3, 1, 3, 1, 2, 0, 2, 2, 2, 1, 3, 1, 1, 0, 0, 2, 1, 1, 3, 3, 0, 1, 3, 1, 1, 1, 0, 1, 3, 2, 0, 3, 0, 2, 1, 1, 3, 3, 1, 3, 2, 0, 3, 2, 0, 1, 3, 1, 2, 1, 0, 2, 1, 0, 0, 2, 1, 1, 3, 1, 2, 1, 3, 0, 0, 1, 1, 3, 1, 2, 1, 1, 1, 3, 0, 1, 1, 1, 1, 1, 1, 0, 1, 3, 0, 3, 3, 0, 0, 1, 1, 3, 1, 1, 3, 0, 2, 2, 3, 2, 0, 0, 1, 3, 1, 3, 3, 1, 2, 3, 0, 1, 3, 0, 0, 3, 2, 2, 1, 1, 3, 1, 1, 3, 3, 1, 3, 1, 1, 3, 2, 2, 2, 1, 0, 0, 0, 1, 0, 1, 3, 0, 1, 3, 0, 3, 3, 0, 1, 0, 1, 3, 1, 0, 1, 1, 2, 2, 2, 1, 3, 1, 0, 0, 1, 2, 3, 0, 1, 3, 0, 0, 3, 1, 0, 1, 2, 2, 1, 1, 1, 3, 0, 3, 0, 1, 3, 1, 1, 1, 3, 3, 3, 0, 1, 0, 3, 0, 3, 3, 3, 0, 3, 1, 0, 3, 0, 0, 1, 0, 1, 0, 0, 1, 2, 0, 2, 2, 1, 0, 1, 0, 1, 3, 3, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 3, 3, 0, 0, 0, 0, 0, 1, 0, 3, 0, 0, 0, 0, 1, 1, 1, 3, 1, 0, 1, 3, 1, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 0, 1, 0, 3, 0, 3, 3, 0, 0, 3, 0, 1, 3, 3, 0, 3, 2, 1, 0, 1, 1, 3, 1, 3, 3, 1, 1, 1, 1, 1, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 0, 0, 1, 1, 1, 3, 1, 0, 0, 1, 1, 1, 3, 0, 0, 1, 0, 3, 1, 0, 3, 3, 0, 1, 3, 2, 2, 1, 3, 3, 3, 0, 1, 3, 1, 1, 1, 3, 2, 3, 0, 0, 0, 1, 0, 3, 0, 2, 3, 3, 3, 0, 0, 3, 1, 0, 0, 0, 0, 1, 0, 3, 3, 0, 2, 0, 3, 3, 2, 3, 2, 0, 0, 3, 1, 3, 0, 0, 1, 0, 0, 3, 0, 2, 0, 2, 2, 1, 3, 1, 2, 4, 0, 0, 0, 1, 1, 3, 1, 3, 3, 2, 1, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 2, 1, 1, 4, 1, 0, 1, 0, 0, 2, 0, 0, 1, 3, 2, 1, 3, 0, 0, 1, 3, 1, 0, 1, 3, 0, 3, 1, 1, 1, 0, 3, 2, 3, 0, 3, 2, 0, 1, 0, 0, 1, 0, 3, 2, 2, 1, 3, 3, 3, 1, 3, 1, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 0, 1, 0, 2, 1, 3, 0, 3, 1, 1, 0, 3, 3, 2, 2, 3, 1, 3, 3, 0, 2, 2, 0, 1, 1, 1, 0, 0, 0, 0, 0, 3, 3, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 2, 1, 0, 0, 3, 2, 3, 0, 1, 0, 1, 1, 0, 1, 1, 0, 3, 0, 2, 1, 1, 0, 3, 3, 1, 3, 0, 0, 1, 2, 1, 3, 0, 0, 1, 1, 3, 1, 1, 1, 3, 0, 0, 3, 3, 1, 1, 1, 1, 1, 1, 0, 3, 3, 0, 1, 0, 2, 1, 1, 0, 1, 1, 1, 3, 3, 0, 3, 3, 0, 0, 1, 1, 1, 1, 0, 0, 3, 0, 0, 0, 0, 0, 2, 0, 0, 1, 3, 3, 0, 3, 0, 1, 1, 1, 2, 1, 0, 1, 3, 0, 1, 2, 3, 0, 0, 0, 0, 0, 3, 2, 0, 1, 1, 0, 3, 3, 2, 1, 1, 3, 1, 3, 0, 1, 1, 3, 3, 3, 0, 3, 0, 0, 3, 1, 0, 2, 1, 1, 3, 0, 3, 3, 3, 1, 1, 1, 0, 1, 0, 0, 3, 0, 0, 3, 0, 3, 3, 1, 0, 3, 2, 3, 2, 1, 0, 1, 0, 2, 0, 1, 1, 0, 0, 2, 0, 0, 0, 1, 1, 0, 3, 3, 0, 3, 3, 3, 1, 0, 0, 0, 1, 3, 2, 0, 1, 0, 1, 3, 2, 0, 0, 1, 3, 2, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 2, 1, 3, 0, 2, 0, 0, 1, 3, 1, 3, 1, 1, 1, 3, 0, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 3, 3, 1, 1, 2, 2, 1, 2, 1, 0, 0, 1, 1, 0, 3, 1, 1, 3, 3, 0, 3, 2, 0, 3, 1, 2, 1, 3, 1, 0, 1, 2, 2, 0, 1, 3, 1, 0, 1, 1, 3, 1, 3, 3, 1, 1, 0, 3, 0, 3, 0, 3, 3, 3, 1, 3, 2, 1, 1, 3, 0, 2, 1, 1, 0, 0, 3, 3, 1, 0, 0, 0, 1, 3, 0, 3, 2, 0, 0, 1, 2, 1, 0, 1, 3, 1, 0, 1, 0, 0, 1, 1, 2, 3, 0, 1, 1, 0, 3, 0, 1, 3, 0, 1, 3, 2, 3, 1, 1, 1, 2, 0, 2, 2, 0, 1, 3, 3, 1, 0, 0, 0, 3, 1, 1, 3, 0, 1, 3, 3, 1, 1, 0, 1, 3, 0, 0, 1, 0, 2, 1, 1, 3, 3, 3, 3, 2, 0, 3, 2, 0, 3, 3, 0, 0, 1, 0, 2, 1, 0, 0, 2, 1, 1, 3, 3, 0, 1, 3, 0, 0, 1, 1, 3, 3, 2, 1, 1, 1, 3, 0, 1, 1, 1, 1, 1, 1, 0, 1, 3, 0, 3, 1, 0, 0, 3, 1, 3, 0, 1, 3, 0, 2, 2, 3, 2, 0, 0, 1, 3, 1, 3, 3, 3, 2, 3, 0, 0, 3, 1, 2, 1, 0, 0, 1, 1, 3, 1, 0, 3, 3, 1, 3, 1, 1, 3, 2, 0, 3, 1, 1, 1, 0, 3, 0, 3, 1, 0, 1, 1, 0, 3, 3, 0, 3, 2, 1, 3, 0, 0, 1, 0, 2, 2, 0, 1, 3, 3, 0, 0, 1, 0, 3, 0, 3, 3, 0, 0, 3, 3, 0, 1, 2, 2, 1, 1, 1, 3, 1, 3, 0, 1, 3, 1, 3, 1, 3, 1, 1, 0, 1, 0, 3, 0, 3, 3, 1, 0, 1, 3, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 2, 0, 2, 2, 0, 0, 1, 0, 1, 3, 1, 0, 1, 0, 1, 0, 3, 1, 0, 1, 0, 3, 0, 0, 3, 1, 0, 0, 1, 0, 3, 0, 0, 0, 2, 1, 1, 1, 1, 1, 1, 3, 3, 1, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 0, 1, 0, 1, 0, 3, 3, 0, 0, 3, 0, 3, 3, 1, 0, 3, 0, 1, 0, 1, 1, 3, 1, 2, 1, 3, 1, 1, 0, 0, 3, 3, 0, 3, 1, 1, 3, 3, 1, 3, 0, 3, 1, 1, 1, 3, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 3, 1, 0, 3, 1, 1, 3, 2, 2, 2, 2, 3, 3, 3, 0, 1, 1, 3, 1, 1, 3, 2, 3, 0, 2, 0, 3, 0, 3, 0, 2, 3, 3, 3, 0, 0, 1, 3, 0, 0, 0, 0, 1, 0, 1, 3, 0, 2, 0, 3, 3, 2, 3, 2, 0, 0, 3, 1, 3, 0, 0, 1, 1, 0, 3, 0, 2, 0, 2, 0, 1, 3, 1, 0, 4, 1, 1, 0, 1, 1, 3, 1, 3, 3, 0, 3, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 0, 1, 3, 4, 1, 2, 1, 0, 0, 2, 2, 0, 1, 3, 2, 1, 3, 0, 0, 1, 1, 1, 0, 3, 2, 3, 0, 1, 1, 1, 2, 3, 0, 1, 1, 3, 0, 0, 0, 0, 3, 3, 0, 1, 2, 2, 3, 3, 3, 3, 1, 3, 1, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 0, 1, 0, 2, 1, 3, 0, 3, 1, 1, 0, 3, 3, 2, 0, 1, 1, 3, 3, 0, 2, 2, 0, 2, 3, 1, 0, 0, 0, 0, 0, 1, 0, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 0, 3, 1, 0, 3, 2, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 3, 1, 0, 3, 3, 0, 3, 0, 0, 1, 0, 0, 1, 1, 1, 3, 3, 0, 3, 1, 3, 1, 1, 1, 3, 0, 0, 1, 3, 1, 3, 1, 1, 1, 0, 0, 3, 3, 3, 3, 3, 2, 1, 1, 0, 1, 1, 1, 3, 1, 0, 3, 1, 0, 0, 1, 1, 1, 3, 3, 0, 1, 0, 0, 0, 0, 0, 0, 1, 2, 3, 1, 1, 0, 3, 0, 1, 1, 1, 0, 2, 0, 3, 3, 0, 1, 2, 3, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 2, 3, 0, 0, 3, 0, 3, 0, 3, 2, 1, 3, 3, 3, 1, 0, 3, 1, 0, 3, 1, 0, 2, 1, 1, 3, 1, 1, 1, 1, 3, 1, 0, 0, 1, 0, 0, 1, 3, 3, 3, 0, 3, 3, 1, 0, 3, 1, 3, 3, 1, 3, 1, 0, 0, 0, 1, 1, 0, 0, 2, 0, 0, 0, 1, 0, 0, 1, 1, 0, 3, 3, 3, 2, 2, 0, 2, 1, 3, 2, 0, 1, 0, 3, 3, 2, 0, 0, 3, 0, 0, 3, 2, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 3, 0, 2, 0, 1, 1, 3, 0, 0, 1, 2, 1, 3, 0, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 3, 3, 1, 3, 2, 2, 1, 2, 1, 0, 0, 1, 1, 0, 3, 1, 1, 3, 1, 0, 3, 2, 0, 3, 3, 2, 1, 3, 1, 0, 1, 2, 2, 0, 1, 3, 1, 0, 1, 1, 3, 1, 3, 3, 1, 1, 0, 3, 0, 3, 0, 3, 3, 3, 1, 3, 2, 1, 1, 3, 0, 2, 1, 1, 0, 0, 3, 3, 1, 0, 0, 0, 1, 3, 0, 3, 2, 0, 0, 1, 2, 1, 0, 1, 3, 1, 0, 1, 0, 0, 1, 1, 2, 3, 0, 1, 1, 0, 3, 0, 1, 3, 0, 1, 3, 2, 3, 1, 1, 1, 2, 2, 2, 2, 0, 1, 3, 3, 1, 0, 0, 0, 3, 1, 1, 3, 0, 1, 3, 3, 1, 1, 0, 1, 3, 0, 0, 1, 0, 2, 1, 3, 3, 3, 1, 3, 2, 0, 3, 2, 0, 3, 3, 0, 0, 1, 0, 2, 1, 0, 0, 2, 1, 1, 3, 3, 0, 1, 3, 0, 0, 1, 1, 3, 3, 2, 1, 1, 1, 3, 0, 1, 1, 1, 1, 1, 1, 0, 1, 3, 0, 3, 1, 0, 0, 1, 1, 3, 0, 1, 3, 0, 2, 2, 3, 2, 0, 0, 1, 3, 1, 3, 3, 3, 2, 3, 0, 0, 3, 1, 2, 1, 2, 0, 1, 1, 3, 1, 0, 3, 3, 1, 3, 1, 1, 3, 2, 2, 3, 1, 1, 1, 0, 3, 0, 3, 1, 0, 1, 1, 0, 3, 3, 0, 3, 0, 3, 3, 0, 0, 1, 0, 2, 2, 0, 3, 3, 3, 0, 0, 1, 0, 3, 0, 1, 3, 0, 0, 3, 3, 0, 1, 2, 2, 1, 1, 1, 3, 1, 3, 0, 1, 3, 1, 1, 1, 3, 1, 1, 0, 1, 0, 3, 0, 3, 3, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 2, 0, 2, 2, 0, 2, 1, 0, 1, 3, 1, 0, 1, 0, 1, 0, 3, 1, 0, 1, 0, 3, 0, 0, 3, 1, 0, 0, 1, 0, 3, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 3, 3, 1, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 0, 1, 0, 3, 0, 3, 3, 0, 0, 3, 0, 3, 3, 1, 0, 3, 0, 1, 0, 1, 1, 3, 1, 2, 1, 3, 1, 1, 0, 0, 3, 1, 0, 3, 1, 1, 3, 1, 1, 3, 0, 3, 1, 3, 1, 3, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 3, 1, 0, 3, 1, 1, 3, 2, 2, 2, 2, 3, 3, 3, 0, 1, 3, 3, 1, 1, 3, 2, 3, 0, 2, 0, 3, 0, 3, 0, 2, 3, 3, 3, 0, 0, 1, 3, 0, 0, 0, 0, 1, 0, 3, 3, 0, 2, 0, 3, 3, 2, 3, 2, 0, 0, 3, 1, 3, 0, 0, 1, 1, 0, 3, 0, 2, 0, 2, 0, 1, 3, 3, 0, 4, 1, 1, 0, 1, 1, 3, 1, 3, 3, 0, 3, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 0, 1, 3, 4, 1, 2, 1, 2, 0, 2, 2, 0, 1, 3, 2, 1, 3, 0, 0, 1, 1, 1, 0, 3, 2, 3, 0, 3, 1, 1, 2, 3, 0, 1, 1, 3, 0, 0, 0, 0, 3, 3, 0, 1, 2, 2, 3, 3, 3, 3, 1, 3, 1, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 0, 1, 0, 2, 1, 3, 0, 3, 1, 1, 0, 3, 3, 2, 0, 1, 1, 3, 3, 0, 2, 2, 0, 2, 3, 1, 0, 0, 0, 0, 0, 3, 0, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 0, 3, 1, 0, 3, 2, 1, 0, 1, 0, 1, 1, 1, 1, 3, 0, 3, 1, 0, 3, 0, 0, 3, 0, 0, 1, 0, 0, 1, 1, 1, 3, 3, 0, 3, 1, 3, 1, 1, 1, 3, 0, 0, 1, 3, 1, 3, 1, 1, 1, 0, 0, 3, 3, 3, 3, 3, 2, 1, 1, 0, 1, 1, 1, 3, 1, 0, 3, 1, 0, 0, 1, 1, 1, 3, 3, 0, 1, 0, 0, 0, 0, 0, 0, 1, 2, 3, 1, 1, 0, 3, 0, 1, 1, 1, 0, 2, 0, 3, 3, 0, 1, 2, 3, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 2, 3, 0, 0, 3, 0, 3, 0, 3, 2, 1, 3, 3, 3, 1, 0, 3, 1, 0, 3, 1, 0, 2, 1, 1, 3, 1, 1, 1, 1, 3, 1, 0, 0, 1, 0, 0, 1, 3, 3, 3, 0, 3, 3, 1, 0, 3, 1, 3, 3, 1, 3, 1, 0, 0, 0, 1, 1, 0, 0, 2, 0, 0, 0, 1, 0, 0, 1, 1, 0, 3, 3, 3, 2, 0, 0, 2, 1, 3, 2, 0, 1, 0, 3, 3, 2, 0, 0, 3, 0, 0, 3, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 3, 0, 2, 0, 1, 1, 3, 0, 0, 1, 0, 1, 3, 0, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 1, 3, 1, 1, 2, 2, 1, 2, 1, 0, 0, 1, 1, 0, 1, 1, 1, 3, 3, 0, 3, 0, 0, 3, 1, 2, 1, 1, 1, 0, 1, 2, 2, 2, 1, 3, 1, 0, 1, 1, 3, 1, 3, 3, 1, 1, 0, 3, 2, 3, 0, 3, 3, 3, 1, 3, 2, 1, 3, 3, 2, 2, 1, 1, 0, 0, 3, 3, 1, 0, 0, 0, 1, 3, 0, 3, 2, 0, 2, 1, 2, 1, 0, 1, 3, 1, 0, 3, 0, 0, 1, 1, 2, 3, 0, 1, 1, 0, 3, 0, 1, 3, 0, 1, 3, 0, 3, 1, 1, 1, 2, 0, 2, 2, 0, 1, 3, 3, 1, 0, 0, 0, 3, 3, 1, 3, 0, 1, 3, 3, 1, 1, 0, 3, 3, 2, 0, 1, 0, 2, 1, 1, 3, 3, 1, 3, 2, 0, 3, 2, 0, 1, 3, 1, 0, 1, 0, 2, 1, 0, 0, 2, 1, 1, 3, 3, 0, 1, 3, 0, 0, 1, 1, 3, 3, 2, 1, 1, 1, 3, 0, 1, 1, 1, 1, 1, 1, 0, 1, 3, 0, 3, 3, 0, 0, 3, 1, 3, 0, 1, 3, 0, 2, 2, 1, 2, 0, 0, 1, 3, 1, 3, 3, 3, 2, 3, 0, 0, 3, 1, 0, 1, 0, 0, 1, 3, 3, 1, 0, 3, 3, 3, 3, 1, 1, 3, 2, 0, 3, 1, 1, 1, 0, 3, 0, 3, 1, 0, 1, 1, 0, 3, 3, 2, 3, 2, 3, 3, 0, 0, 1, 2, 2, 2, 1, 1, 3, 3, 0, 0, 3, 0, 3, 0, 1, 3, 0, 0, 3, 1, 0, 1, 0, 2, 1, 1, 1, 3, 1, 3, 0, 1, 3, 1, 3, 1, 3, 1, 1, 0, 1, 0, 3, 2, 3, 3, 1, 0, 3, 3, 0, 1, 0, 2, 3, 0, 1, 0, 0, 1, 2, 0, 2, 2, 0, 0, 1, 0, 1, 3, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 3, 0, 0, 3, 1, 0, 0, 3, 0, 3, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 3, 3, 1, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 0, 1, 0, 3, 0, 3, 3, 0, 0, 3, 0, 3, 3, 1, 0, 3, 0, 1, 0, 1, 1, 3, 1, 2, 1, 3, 1, 1, 0, 0, 3, 3, 0, 3, 1, 1, 3, 3, 1, 3, 0, 3, 1, 3, 1, 3, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 3, 1, 0, 3, 1, 1, 3, 2, 2, 2, 2, 3, 3, 3, 0, 1, 1, 3, 1, 1, 3, 2, 3, 0, 0, 0, 3, 0, 3, 0, 2, 3, 3, 3, 0, 0, 1, 3, 0, 0, 0, 0, 1, 0, 3, 3, 0, 2, 0, 3, 3, 2, 3, 2, 0, 0, 3, 1, 3, 0, 0, 1, 3, 0, 3, 0, 2, 0, 2, 2, 1, 1, 3, 0, 4, 1, 1, 0, 1, 3, 3, 1, 3, 3, 0, 3, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 0, 1, 3, 4, 1, 2, 1, 0, 0, 2, 2, 0, 1, 3, 2, 1, 3, 0, 0, 3, 1, 1, 0, 3, 2, 1, 1, 3, 1, 1, 2, 3, 0, 1, 3, 3, 0, 0, 0, 0, 1, 3, 0, 1, 2, 2, 3, 3, 3, 1, 1, 3, 1, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 0, 1, 0, 2, 1, 3, 0, 3, 1, 1, 0, 3, 3, 2, 0, 1, 1, 3, 3, 0, 2, 2, 0, 2, 3, 1, 0, 0, 0, 0, 0, 1, 0, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 0, 3, 1, 0, 3, 2, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 3, 1, 0, 3, 0, 0, 3, 0, 0, 1, 0, 0, 1, 1, 1, 3, 1, 0, 3, 1, 3, 1, 1, 1, 3, 2, 0, 1, 1, 1, 3, 3, 1, 1, 0, 0, 3, 3, 3, 3, 3, 2, 1, 1, 0, 1, 1, 1, 3, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 3, 0, 3, 0, 0, 0, 0, 0, 0, 1, 2, 3, 3, 1, 0, 3, 0, 1, 1, 1, 0, 2, 0, 1, 3, 0, 1, 2, 3, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 2, 3, 0, 0, 3, 0, 3, 0, 3, 2, 1, 3, 3, 3, 3, 0, 3, 3, 0, 1, 1, 0, 2, 3, 1, 3, 1, 1, 1, 1, 3, 1, 0, 0, 1, 0, 0, 1, 1, 1, 3, 0, 3, 3, 1, 0, 3, 1, 1, 3, 1, 3, 1, 0, 0, 0, 1, 1, 0, 0, 2, 0, 0, 0, 1, 0, 0, 1, 1, 0, 3, 3, 3, 2, 2, 0, 2, 3, 3, 2, 0, 1, 0, 3, 3, 2, 0, 0, 3, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 3, 3, 0, 2, 0, 1, 1, 3, 0, 0, 1, 0, 1, 3, 0, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 1, 3, 1, 1, 2, 2, 3, 2, 1, 0, 0, 1, 3, 0, 3, 1, 1, 3, 3, 0, 3, 0, 2, 3, 3, 2, 1, 1, 1, 0, 3, 2, 2, 0, 1, 3, 1, 0, 1, 1, 3, 1, 3, 3, 1, 1, 0, 3, 0, 3, 0, 1, 3, 3, 1, 3, 2, 1, 3, 3, 2, 2, 1, 1, 0, 0, 1, 3, 1, 0, 0, 0, 1, 3, 0, 1, 2, 0, 0, 1, 2, 1, 0, 1, 1, 1, 0, 1, 0, 2, 1, 1, 2, 1, 0, 3, 1, 0, 3, 0, 1, 3, 0, 1, 3, 0, 3, 1, 1, 1, 2, 0, 2, 2, 0, 1, 3, 1, 1, 0, 0, 0, 3, 1, 1, 3, 0, 1, 3, 1, 1, 1, 0, 1, 3, 0, 0, 1, 0, 2, 1, 1, 3, 3, 1, 3, 2, 0, 3, 2, 0, 3, 3, 1, 0, 1, 0, 2, 1, 0, 0, 2, 1, 1, 3, 3, 0, 1, 3, 0, 0, 3, 1, 3, 3, 2, 1, 3, 1, 3, 0, 1, 1, 1, 3, 1, 1, 0, 1, 3, 0, 3, 3, 0, 0, 3, 1, 3, 0, 1, 3, 2, 2, 2, 1, 2, 0, 0, 1, 3, 1, 3, 3, 1, 2, 3, 0, 0, 3, 1, 2, 1, 0, 0, 1, 1, 3, 1, 0, 3, 3, 3, 3, 1, 1, 3, 2, 0, 3, 1, 1, 1, 0, 1, 0, 3, 1, 0, 1, 1, 0, 3, 1, 0, 3, 0, 1, 3, 0, 0, 1, 0, 2, 2, 0, 1, 3, 2, 0, 0, 1, 0, 3, 0, 1, 3, 0, 0, 3, 3, 0, 1, 0, 2, 1, 1, 1, 3, 1, 3, 0, 1, 3, 1, 3, 1, 3, 3, 1, 0, 1, 0, 3, 0, 3, 3, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 2, 0, 2, 2, 0, 2, 1, 2, 1, 3, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 3, 0, 0, 3, 3, 0, 0, 1, 0, 3, 0, 0, 0, 0, 1, 1, 0, 1, 1, 3, 3, 3, 1, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 0, 1, 0, 3, 0, 3, 3, 0, 0, 3, 0, 1, 3, 1, 0, 3, 0, 1, 0, 1, 1, 3, 1, 2, 1, 3, 1, 1, 0, 0, 3, 3, 0, 3, 3, 1, 3, 3, 1, 3, 0, 3, 1, 3, 1, 3, 3, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 3, 1, 0, 3, 3, 1, 3, 0, 2, 2, 0, 3, 3, 3, 0, 1, 3, 3, 1, 1, 3, 2, 3, 0, 0, 0, 3, 0, 3, 0, 2, 3, 3, 3, 0, 0, 3, 3, 0, 0, 0, 0, 1, 0, 3, 3, 0, 2, 0, 1, 3, 2, 3, 2, 0, 0, 3, 1, 3, 0, 0, 1, 3, 0, 3, 0, 2, 0, 0, 2, 1, 3, 3, 0, 4, 1, 1, 0, 1, 3, 3, 1, 3, 3, 0, 3, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 0, 1, 3, 4, 3, 2, 1, 0, 0, 2, 2, 0, 1, 1, 2, 1, 3, 0, 0, 3, 1, 1, 0, 1, 0, 1, 1, 3, 1, 1, 2, 3, 0, 1, 3, 3, 0, 0, 0, 0, 1, 3, 0, 1, 2, 2, 3, 3, 3, 3, 1, 3, 1, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 0, 1, 0, 2, 1, 3, 0, 3, 1, 1, 0, 3, 3, 2, 2, 1, 1, 3, 3, 0, 2, 2, 0, 2, 3, 1, 0, 0, 0, 0, 0, 3, 0, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 0, 3, 1, 0, 3, 2, 3, 0, 3, 0, 1, 1, 1, 1, 1, 0, 3, 1, 0, 3, 0, 0, 3, 0, 0, 1, 0, 0, 1, 3, 1, 3, 1, 0, 3, 1, 3, 1, 1, 1, 3, 0, 0, 1, 3, 1, 3, 3, 1, 1, 0, 0, 3, 3, 3, 3, 1, 2, 1, 3, 0, 1, 1, 1, 3, 3, 0, 3, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 3, 0, 3, 0, 3, 1, 1, 0, 0, 0, 1, 3, 0, 1, 2, 3, 0, 0, 0, 0, 0, 1, 0, 2, 1, 1, 2, 3, 0, 0, 3, 0, 3, 0, 3, 2, 1, 3, 3, 3, 1, 0, 3, 3, 0, 1, 1, 0, 2, 1, 1, 3, 1, 3, 1, 3, 3, 1, 0, 0, 1, 0, 0, 1, 3, 3, 3, 0, 3, 0, 3, 0, 3, 0, 3, 3, 1, 3, 3, 0, 0, 0, 1, 1, 0, 0, 2, 0, 0, 0, 1, 0, 0, 3, 1, 0, 3, 1, 3, 2, 0, 0, 2, 1, 3, 2, 2, 1, 0, 1, 3, 2, 0, 0, 3, 0, 0, 3, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 3, 0, 0, 2, 1, 1, 3, 0, 0, 1, 0, 3, 3, 0, 0, 2, 1, 3, 3],
[0, 0, 2, 1, 3, 3, 1, 0, 1, 1, 2, 2, 1, 2, 1, 0, 0, 3, 2, 0, 3, 1, 1, 3, 0, 0, 3, 0, 0, 3, 1, 2, 1, 3, 1, 0, 1, 2, 2, 2, 3, 3, 3, 0, 1, 3, 3, 1, 2, 3, 1, 3, 0, 3, 2, 1, 3, 0, 3, 3, 1, 3, 2, 1, 1, 3, 0, 2, 1, 0, 0, 0, 1, 3, 1, 0, 0, 0, 3, 3, 0, 1, 2, 0, 0, 1, 2, 0, 0, 3, 3, 1, 0, 1, 0, 2, 1, 1, 2, 0, 0, 1, 0, 0, 3, 0, 0, 1, 0, 3, 3, 3, 0, 1, 3, 1, 2, 0, 2, 2, 2, 1, 3, 1, 1, 0, 0, 0, 1, 0, 1, 3, 0, 3, 3, 1, 1, 1, 2, 1, 3, 3, 0, 3, 0, 2, 2, 1, 1, 3, 1, 3, 2, 0, 3, 2, 0, 1, 3, 1, 1, 3, 0, 2, 1, 0, 0, 0, 3, 1, 3, 1, 2, 1, 3, 0, 0, 1, 1, 3, 1, 2, 1, 1, 1, 3, 0, 1, 1, 1, 0, 1, 0, 2, 1, 3, 0, 3, 3, 0, 0, 3, 1, 3, 0, 2, 3, 0, 2, 2, 0, 2, 0, 0, 3, 3, 0, 1, 3, 1, 0, 1, 0, 0, 3, 1, 2, 3, 0, 3, 1, 3, 3, 1, 1, 3, 3, 1, 3, 1, 3, 3, 2, 0, 3, 1, 1, 0, 0, 1, 3, 3, 3, 0, 1, 3, 0, 3, 3, 0, 3, 0, 3, 3, 1, 0, 1, 0, 2, 2, 0, 1, 3, 3, 0, 0, 3, 0, 3, 0, 1, 3, 0, 0, 3, 3, 0, 1, 0, 2, 1, 0, 1, 3, 1, 3, 0, 1, 3, 1, 0, 1, 3, 3, 1, 0, 3, 0, 3, 2, 3, 0, 3, 2, 1, 1, 3, 1, 3, 0, 1, 0, 1, 0, 2, 1, 2, 0, 2, 2, 3, 1, 1, 0, 1, 3, 3, 0, 1, 0, 3, 0, 1, 0, 2, 1, 0, 1, 1, 0, 2, 1, 0, 0, 3, 0, 3, 0, 0, 0, 0, 1, 1, 0, 0, 3, 0, 3, 3, 3, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 0, 3, 0, 1, 2, 1, 3, 0, 0, 3, 0, 3, 3, 3, 0, 3, 0, 1, 0, 3, 0, 3, 0, 0, 1, 0, 1, 1, 0, 0, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 3, 0, 1, 1, 3, 3, 2, 0, 2, 1, 1, 1, 1, 0, 0, 2, 2, 3, 0, 0, 3, 3, 0, 3, 0, 2, 2, 0, 1, 1, 1, 3, 1, 0, 1, 1, 3, 3, 2, 3, 0, 0, 3, 3, 0, 3, 0, 2, 3, 3, 3, 0, 2, 1, 3, 0, 0, 0, 0, 1, 0, 3, 3, 0, 2, 0, 3, 3, 2, 3, 2, 0, 0, 3, 1, 3, 0, 0, 3, 0, 0, 3, 0, 2, 0, 0, 2, 0, 0, 3, 0, 4, 3, 0, 0, 1, 3, 3, 1, 3, 3, 0, 0, 3, 3, 0, 1, 1, 2, 0, 2, 0, 0, 0, 2, 3, 2, 4, 1, 2, 1, 0, 0, 2, 0, 0, 1, 3, 2, 1, 3, 0, 0, 3, 3, 1, 0, 3, 2, 1, 3, 1, 1, 1, 0, 0, 2, 0, 1, 3, 0, 0, 1, 0, 0, 1, 3, 3, 2, 2, 1, 3, 3, 1, 1, 3, 1, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0, 2, 2, 0, 3, 0, 2, 3, 0, 2, 3, 3, 0, 3, 1, 1, 0, 3, 3, 2, 2, 3, 1, 3, 3, 0, 2, 2, 0, 2, 1, 1, 0, 0, 0, 0, 0, 1, 0, 3, 3, 2, 2, 3, 2, 1, 0, 0, 1, 3, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 3, 0, 4, 4, 4, 0, 3, 0, 1, 0, 1, 3, 3, 1, 3, 1, 1, 0, 3, 1, 0, 1, 3, 1, 3, 0, 0, 3, 0, 0, 1, 0, 1, 3, 0, 0, 3, 3, 0, 2, 1, 1, 3, 0, 1, 3, 0, 2, 1, 2, 1, 1, 0, 0, 3, 1, 1, 3, 0, 2, 1, 3, 0, 1, 1, 1, 3, 1, 0, 3, 3, 0, 0, 1, 1, 1, 3, 0, 0, 1, 0, 0, 0, 0, 2, 1, 0, 1, 0, 1, 3, 0, 3, 0, 1, 1, 1, 2, 3, 0, 1, 3, 0, 1, 2, 3, 0, 0, 0, 0, 1, 3, 0, 2, 1, 1, 0, 3, 1, 0, 3, 1, 3, 0, 1, 2, 1, 1, 1, 3, 1, 0, 3, 3, 0, 1, 1, 0, 2, 3, 0, 1, 1, 3, 3, 0, 3, 1, 3, 0, 3, 0, 0, 3, 0, 3, 3, 1, 3, 3, 3, 0, 3, 1, 1, 3, 3, 0, 1, 0, 2, 2, 1, 1, 0, 0, 2, 0, 0, 3, 1, 0, 0, 3, 0, 0, 3, 3, 3, 1, 0, 0, 0, 1, 3, 2, 0, 1, 0, 1, 3, 2, 0, 0, 3, 0, 0, 1, 3, 0, 3, 1, 1, 0, 0, 0, 1, 1, 0, 3, 1, 0, 0, 0, 1, 3, 0, 3, 1, 1, 1, 3, 0, 0, 2, 1, 3, 3]
]
let seqLength = 898
let sapply = lam x. lam f.
  map f x

recursive let zipAll = lam lists.
if (any null lists) then []
else
  let heads = map head lists in
  let tails = map tail lists in
  snoc (zipAll tails) heads
end

let mapIndex = lam f. lam n.
  recursive let helper = lam acc. lam i.
  if eqi i n then reverse acc
  else helper (cons (f i) acc) (addi i 1)
  in helper [] 0
con Node : {age: Float, msg: [[Float]], left: Tree, right: Tree, lastWeight:Float} -> Tree
let getAge = lam n. match n with Node r then r.age else match n with Leaf r then r.age else never
let getMsg = lam n. match n with Leaf r then r.msg else match n with Node r then r.msg else never

let slice = lam seq. lam beg. lam mend.
    subsequence seq beg (subi mend beg)

/-let matrixGet = lam row. lam col. lam mtx.
  matGetExn mtx row col-/

let pickpair = lam n.
  let i = assume (UniformDiscrete 0 (subi n 1)) in
  let j = assume (UniformDiscrete 0 (subi n 2)) in
  if lti j i then (i,j) else (i,addi j 1)

let iid = lam f. lam p. lam n.
  let params = make n p in
  map f params
let jcProbs = lam i. lam j. lam t.
  if eqi i j then addf 0.25 (mulf 0.75 (exp (negf (mulf (divf 4. 3.) t))))
  else subf 0.25 (mulf 0.25 (exp (negf (mulf (divf 4. 3.) t))))

let getLeafMessage = lam seq:Int.
  if eqi seq 0 then [1.0, 0.0, 0.0, 0.0]
  else if eqi seq 1 then [0.0, 1.0, 0.0, 0.0]
  else if eqi seq 2 then [0.0, 0.0, 1.0, 0.0]
  else if eqi seq 3 then [0.0, 0.0, 0.0, 1.0]
  else if eqi seq 4 then [1.0, 1.0, 1.0, 1.0]
  else error "Invalid state at leaf"

let getLogLikes = lam msg. lam pi.
  let like = foldl2 (lam acc. lam x. lam p. addf acc (mulf x p)) 0. msg pi in
  log like

/-let ctmc = lam i. lam qt.
  [matrixGet i 0 qt,matrixGet i 1 qt,matrixGet i 2 qt,matrixGet i 3 qt]
-/
recursive
let buildForest =  lam data. lam forest:[Tree]. lam index. lam data_len. lam seq_len.
  foldl (lam forest. lam data.
    let newMessage = sapply data getLeafMessage in
    let newLeaf = Leaf {age=0.0,msg = newMessage,id=length forest} in
    let newForest = join ([forest,[newLeaf]]) in
    newForest
  ) [] data
end

recursive
let cluster = lam trees. lam maxAge. lam seqLen. lam n.
  if eqi n 1 then trees else
  let pairs = pickpair n in
  let leftChild = get trees pairs.0 in
  let rightChild = get trees pairs.1 in
  let children = [leftChild, rightChild] in

  let t = assume (Exponential 10.0) in
  let age = addf t maxAge in
  --let qts = map (lam c. matExpExn (matScale (subf age (getAge c)) q)) children in
  --let ps = map (lam qt. map (lam i. ctmc i qt) [0,1,2,3]) qts in
  let ps = map (lam c. let t = (subf age (getAge c)) in map (lam i. map (lam j. jcProbs i j t) [0,1,2,3]) [0,1,2,3]) children in

  let msgs = reverse (zipAll (map getMsg children)) in
  iter (lam c. match c with Node n then weight (negf n.lastWeight) else ()) children;

  let res = mapIndex (lam i.
    let msg = get msgs i in
    let childMsgs = zipWithIndex (lam j. lam child. lam p1.
      let msg = get msg j in
      map (lam p. foldl2 (lam acc. lam pi. lam lci. addf acc (mulf pi lci)) 0. p msg) p1
    ) children ps in
    let node_msg = foldl (lam acc. lam m. zipWith mulf acc m) (head childMsgs) (tail childMsgs) in
    let lastW = (if gti n 2 then log (foldl addf 0. node_msg) else getLogLikes node_msg [0.25,0.25,0.25,0.25]) in
    (node_msg, lastW)
  ) seqLen in
  match mapAccumL (lam acc. lam r. (addf acc r.1,r.0)) 0. res with (lastW,node_msg) in
  weight lastW;
  resample;
  let parent = Node {age=age, msg = node_msg,left = leftChild, right = rightChild, lastWeight=lastW} in
  let min = mini pairs.0 pairs.1 in
  let max = maxi pairs.0 pairs.1 in
  let new_trees = join ([slice trees 0 min, slice trees (addi min 1) max, slice trees (addi max 1) n, [parent]]) in
  cluster new_trees age seqLen (subi n 1)
end

let model = lam.
  let q = [negf 1., divf 1. 3., divf 1. 3., divf 1. 3.,
   divf 1. 3., negf 1., divf 1. 3., divf 1. 3.,
   divf 1. 3., divf 1. 3.,negf 1., divf 1. 3.,
   divf 1. 3., divf 1. 3., divf 1. 3., negf 1.] in
  --let q = matFromArrExn 4 4 (extArrOfSeq extArrKindFloat64 q) in
  let trees:[Tree] = buildForest data [] 0 (length data) seqLength in
  cluster trees 0.0 seqLength (length trees)
mexpr
recursive
let collectSplits = lam tree.
  match tree with Leaf l then
    ([l.id], [])                  -- (leaf set, splits)
  else match tree with Node n then
    match collectSplits n.left with (leftLeaves, leftSplits) in
    match collectSplits n.right with (rightLeaves, rightSplits) in
    let thisLeaves = join [leftLeaves, rightLeaves] in
    let thisSplit  = thisLeaves in      -- or smaller side of the bipartition
    let allSplits  = join [leftSplits, rightSplits, [thisSplit]] in
    (thisLeaves, allSplits)
  else error "unexpected"
in
let tree = model () in
match collectSplits (get tree 0) with (_, splits) in
--splits
recursive
let iterateTree = lam tree. lam tl.
  let age = getAge tree in
  match tree with Node n then
    let t = subf age (getAge n.left) in
    let tl = iterateTree n.left (cons t tl) in
    let t = subf age (getAge n.right) in
    iterateTree n.right (cons t tl)
  else match tree with Leaf l then
    tl
  else tl
in
let branchLengths = iterateTree (get tree 0) [] in
splits
